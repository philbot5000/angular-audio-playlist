"use strict";angular.module("ngAudioPlayerApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("ngAudioPlayerApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ngAudioPlayerApp").controller("AudioController",["$scope","$attrs",function(a){this.playerControls={playIcon:'<i class="fa fa-play fa-lg"></i>',pauseIcon:'<i class="fa fa-pause fa-lg"></i>',loadingIcon:'<i class="fa fa-circle-o-notch fa-spin fa-lg"></i>'},a.player={buttonIcon:this.playerControls.playIcon},a.playlist=[{order:0,name:"David Bowie",song:"John, I'm only dancing",src:"audio/bowie.mp3"},{order:1,name:"The Black Angels",song:"Winter 68",src:"http://reviewstalker.com/wp-content/uploads/2011/10/03-Winter-68.mp3"},{order:2,name:"The Beatles",song:"Winter 68",src:"http://reviewstalker.com/wp-content/uploads/2011/10/03-Winter-68.mp3"}],console.log(a.playlist[0]),a.currentlyPlaying=a.playlist[0],this.timeElapsed=function(a){var b=a,c=Math.floor(b%60),d=10>c?"0"+c:c,e=Math.floor(b/60%60),f=10>e?"0"+e:e,g=Math.floor(b/60/60%60);return 0===g?f+":"+d:g+":"+f+":"+d},this.timeRemaining=function(a,b){var c=a,d=b,e=c-d,f=Math.floor(e%60)||0,g=10>f?"0"+f:f,h=Math.floor(e/60%60)||0,i=10>h?"0"+h:h,j=Math.floor(e/60/60%60)||0;return 0===j?"-"+i+":"+g:"-"+j+":"+i+":"+g},this.percentLoaded=function(a,b){return parseInt(b/a*100,10)},this.percentElapsed=function(a,b){return Math.floor(100/a*b)||0},this.toggleAudio=function(){a.audio.paused?a.audio.play():a.audio.pause()},a.playTrack=function(b){a.audio.src=b.src,a.currentlyPlaying=b,a.audio.load(),a.audio.play()},this.nextTrack=function(){},this.previousTrack=function(){}}]).directive("ngAudioPlayer",function(){return{templateUrl:"views/ng-audio-player.html",restrict:"A",scope:!0,controller:"AudioController",link:function(a,b,c,d){var e=b.find("audio")[0];a.audio=e,e.src=a.currentlyPlaying.src,e.addEventListener("timeupdate",function(){var b=this.currentTime,c=this.duration;a.$apply(function(){a.currentTime=d.timeElapsed(b),a.remainingTime=d.timeRemaining(c,b),a.percentElapsed=d.percentElapsed(c,b)})}),e.addEventListener("playing",function(){a.$apply(function(){a.player.buttonIcon=d.playerControls.pauseIcon})}),e.addEventListener("pause",function(){a.$apply(function(){a.player.buttonIcon=d.playerControls.playIcon})}),e.addEventListener("ended",function(){var b=a.currentlyPlaying.order+1;a.currentlyPlaying=a.playlist[b],e.load(),e.play()}),e.addEventListener("progress",function(){var b=this.duration,c=this.buffered.end(0);a.$apply(function(){a.percentLoaded=d.percentLoaded(b,c)})}),e.addEventListener("waiting",function(){a.$apply(function(){a.player.buttonIcon=d.playerControls.loadingIcon})});var f=b.find("button");f.bind("click",function(){d.toggleAudio()})}}});